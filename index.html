<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAN Logger Architecture & Improvement Plan</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #e0e0e0;
            background-color: #1e1e1e;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #4fc3f7;
            border-bottom: 2px solid #4fc3f7;
            padding-bottom: 10px;
            font-weight: 400;
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
        }
        h2 {
            font-size: 2em;
            margin-top: 40px;
        }
        h3 {
            font-size: 1.5em;
            border-bottom: 1px solid #0288d1;
        }
        p, li {
            font-size: 1.1em;
            color: #cccccc;
        }
        code {
            background-color: #2d2d2d;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: "Fira Code", "Courier New", monospace;
            color: #ffcc80;
        }
        .card {
            background-color: #2a2a2a;
            border: 1px solid #383838;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .diagram-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: #252525;
            border-radius: 8px;
        }
        svg {
            width: 100%;
            max-width: 900px;
            height: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #444;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #0277bd;
            color: #ffffff;
        }
        td {
            background-color: #333;
        }
        .flex-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-start;
        }
        .flex-item {
            flex: 1;
            min-width: 300px;
        }
        .improvement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .improvement-card {
            background-color: #2c2c2c;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        .improvement-card svg {
            width: 60px;
            height: 60px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>CAN Logger Architecture & Improvement Plan</h1>

        <div class="card">
            <h2>1. Current Multi-Process/Thread Implementation</h2>
            <p>The application is designed as a high-performance pipeline to prevent data loss from the high-frequency CAN bus. It achieves this by separating tasks into different processes and threads, primarily within the <code>can_logger_app</code>.</p>
            
            <div class="diagram-container">
                <h3>System Architecture Diagram</h3>
                <svg viewBox="0 0 800 450" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#4fc3f7" />
                        </marker>
                    </defs>
                    
                    <rect x="10" y="10" width="780" height="430" fill="none" stroke="#555" stroke-width="2" rx="10"/>
                    <text x="400" y="35" font-family="sans-serif" font-size="16" fill="#ccc" text-anchor="middle">Main Application Process</text>

                    <rect x="30" y="60" width="440" height="360" fill="#2a2a2a" stroke="#0288d1" stroke-width="2" rx="10"/>
                    <text x="250" y="85" font-family="sans-serif" font-size="16" fill="#ccc" text-anchor="middle">can_logger_app (Multiprocessing.Process)</text>

                    <rect x="500" y="180" width="270" height="100" fill="#2a2a2a" stroke="#0288d1" stroke-width="2" rx="10"/>
                    <text x="635" y="205" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">Radar Tracker</text>
                    <text x="635" y="225" font-family="sans-serif" font-size="12" fill="#aaa" text-anchor="middle">(main_live / QThread)</text>

                    <rect x="50" y="120" width="120" height="50" fill="#333" rx="5"/>
                    <text x="110" y="150" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">CAN Hardware</text>

                    <rect x="230" y="120" width="120" height="50" fill="#3c3c3c" rx="5"/>
                    <text x="290" y="142" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">CANReader</text>
                    <text x="290" y="160" font-family="sans-serif" font-size="10" fill="#aaa" text-anchor="middle">(Threading.Thread)</text>
                    <line x1="170" y1="145" x2="230" y2="145" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>

                    <ellipse cx="290" cy="210" rx="50" ry="15" fill="#81d4fa"/>
                    <text x="290" y="215" font-family="sans-serif" font-size="12" fill="#111" text-anchor="middle">raw_mp_queue</text>
                    <line x1="290" y1="170" x2="290" y2="195" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>

                    <rect x="180" y="250" width="220" height="60" fill="#3c3c3c" rx="5"/>
                    <text x="290" y="272" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">Decoding Workers</text>
                    <text x="290" y="290" font-family="sans-serif" font-size="10" fill="#aaa" text-anchor="middle">(Multiprocessing.Process Pool)</text>
                    <line x1="290" y1="225" x2="290" y2="250" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>

                    <ellipse cx="130" cy="350" rx="50" ry="15" fill="#81d4fa"/>
                    <text x="130" y="355" font-family="sans-serif" font-size="12" fill="#111" text-anchor="middle">log_queue</text>
                    <path d="M 230 310 Q 180 320 155 340" stroke="#4fc3f7" stroke-width="2" fill="none" marker-end="url(#arrow)"/>

                    <rect x="50" y="380" width="120" height="30" fill="#3c3c3c" rx="5"/>
                    <text x="110" y="400" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">LogWriter</text>
                    <line x1="110" y1="365" x2="110" y2="380" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>

                    <path d="M 20 400 L 50 390 L 50 410 Z" fill="#ffcc80"/>
                    <text x="35" y="425" font-family="sans-serif" font-size="12" fill="#ccc" text-anchor="middle">can_log.json</text>
                    <line x1="50" y1="400" x2="20" y2="400" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>

                    <rect x="550" y="100" width="170" height="40" fill="#b39ddb" rx="5"/>
                    <text x="635" y="125" font-family="sans-serif" font-size="12" fill="#111" text-anchor="middle">shared_live_can_data (dict)</text>
                    <path d="M 350 310 Q 450 280 550 130" stroke="#4fc3f7" stroke-width="2" fill="none" marker-end="url(#arrow)"/>
                    <line x1="635" y1="140" x2="635" y2="180" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>
                </svg>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Component</th><th>Module</th><th>Type</th><th>Responsibilities</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Main Application</strong></td><td><code>main.py</code></td><td>Main Process</td><td>1. Starts and manages all other processes.<br>2. Creates shared data structures (dictionaries, events).<br>3. Runs the <code>radar_tracker</code> application logic.</td>
                    </tr>
                    <tr>
                        <td><strong>CAN Bus Reader</strong></td><td><code>can_handler.py</code></td><td><code>threading.Thread</code></td><td>1. Connects directly to the CAN hardware.<br>2. Reads raw messages from the bus as fast as possible.<br>3. Puts raw messages onto a <code>multiprocessing.Queue</code>.</td>
                    </tr>
                    <tr>
                        <td><strong>Decoding Workers</strong></td><td><code>data_processor.py</code></td><td><code>multiprocessing.Process</code> Pool</td><td>1. Read raw messages from the queue.<br>2. Decode binary data into physical values (e.g., km/h, Nm).<br>3. Send decoded data to both the log queue and the live data dictionary.</td>
                    </tr>
                    <tr>
                        <td><strong>Log Writer</strong></td><td><code>log_writer.py</code></td><td><code>threading.Thread</code></td><td>1. Reads decoded signals in batches from the log queue.<br>2. Writes data to the final <code>can_log.json</code> file on disk.</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="card">
            <h2>2. The Proposed Change and Its Justification</h2>
            <div class="flex-container">
                <div class="flex-item">
                    <h3>The "What"</h3>
                    <p>I proposed changing a single line in <code>src/can_logger_app/main.py</code> to switch from a dynamic number of worker processes to a fixed number.</p>
                    <p><b>From (Dynamic):</b> <code>num_processes = (os.cpu_count() or 2) - 1</code></p>
                    <p><b>To (Fixed):</b> <code>num_processes = 2</code></p>
                    <h3>The "Why"</h3>
                    <p>You mentioned you are "continuously facing issues reading the vehicle CAN signals." In a complex, concurrent system, intermittent problems are often the hardest to solve.</p>
                    <ul>
                        <li><strong>Reducing Variability:</strong> By dynamically setting the number of worker processes based on the CPU count, the application behaves differently on different machines. This variability can hide or trigger bugs.</li>
                        <li><strong>Creating a Stable Baseline:</strong> Fixing the number of workers to a constant value (like 2) makes the system's behavior <strong>deterministic and repeatable</strong>. This is a crucial first step in debugging, as it eliminates a major variable and helps isolate the source of the reading issues.</li>
                    </ul>
                </div>
                <div class="flex-item diagram-container">
                    <svg viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                        <text x="100" y="25" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">Before: Dynamic</text>
                        <rect x="50" y="40" width="100" height="100" fill="#333" rx="5"/>
                        <rect x="60" y="50" width="35" height="35" fill="#f44336"/><rect x="105" y="50" width="35" height="35" fill="#f44336"/><rect x="60" y="95" width="35" height="35" fill="#f44336"/><rect x="105" y="95" width="35" height="35" fill="#555"/>
                        <text x="100" y="160" font-family="sans-serif" font-size="12" fill="#aaa" text-anchor="middle">e.g., 3 workers on 4 cores</text>

                        <text x="300" y="25" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">After: Fixed</text>
                        <rect x="250" y="40" width="100" height="100" fill="#333" rx="5"/>
                        <rect x="260" y="50" width="35" height="35" fill="#4caf50"/><rect x="305" y="50" width="35" height="35" fill="#4caf50"/><rect x="260" y="95" width="35" height="35" fill="#555"/><rect x="305" y="95" width="35" height="35" fill="#555"/>
                        <text x="300" y="160" font-family="sans-serif" font-size="12" fill="#aaa" text-anchor="middle">2 workers, always</text>
                    </svg>
                </div>
            </div>
        </div>

        <div class="card">
            <h2>3. Recommended Pipeline Improvements</h2>
            <p>Beyond the immediate change, here are several methods we could implement to further improve the pipeline's performance and reliability.</p>
            <div class="improvement-grid">
                <div class="improvement-card">
                    <svg viewBox="0 0 24 24"><path fill="#4fc3f7" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
                    <h3>Profile for Bottlenecks</h3>
                    <p>Use tools like <code>cProfile</code> to get a detailed breakdown of where the application is spending the most time. This provides concrete data to guide optimization efforts.</p>
                </div>
                <div class="improvement-card">
                    <svg viewBox="0 0 24 24"><path fill="#ffb74d" d="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.47 2,12C2,17.53 6.47,22 12,22C17.53,22 22,17.53 22,12C22,6.47 17.53,2 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20Z" /></svg>
                    <h3>Monitor Queue Health</h3>
                    <p>Add a monitoring thread to periodically check queue sizes. If a queue is consistently full, it's a clear sign of a bottleneck, providing an immediate diagnosis.</p>
                </div>
                <div class="improvement-card">
                    <svg viewBox="0 0 24 24"><path fill="#81c784" d="M12,2A2,2 0 0,0 10,4V8A2,2 0 0,0 12,10A2,2 0 0,0 14,8V4A2,2 0 0,0 12,2M17,12A1,1 0 0,0 16,11H8A1,1 0 0,0 7,12A1,1 0 0,0 8,13H16A1,1 0 0,0 17,12M12,14A2,2 0 0,0 10,16V20A2,2 0 0,0 12,22A2,2 0 0,0 14,20V16A2,2 0 0,0 12,14M4,10A2,2 0 0,0 2,12A2,2 0 0,0 4,14H8A2,2 0 0,0 10,12A2,2 0 0,0 8,10H4M16,14A2,2 0 0,0 14,12A2,2 0 0,0 16,10H20A2,2 0 0,0 22,12A2,2 0 0,0 20,14H16Z" /></svg>
                    <h3>CPU Core Pinning</h3>
                    <p>On Linux, assign processes to specific CPU cores. This reduces context-switching and improves cache efficiency, leading to more consistent real-time performance.</p>
                </div>
                <div class="improvement-card">
                    <svg viewBox="0 0 24 24"><path fill="#ba68c8" d="M20,18H4V8H20M20,6H4A2,2 0 0,0 2,8V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8A2,2 0 0,0 20,6M11,14H9V12H11M13,14H15V12H13M17,14H19V12H17Z" /></svg>
                    <h3>Re-evaluate Shared Memory</h3>
                    <p>Instead of queues, use a pre-allocated <code>multiprocessing.shared_memory</code> block. This can be significantly faster by avoiding data serialization overhead, but is more complex to implement.</p>
                </div>
            </div>
        </div>

        <!-- NEW SECTION START -->
        <div class="card">
            <h2>4. Architectural Evolution: Specialized Pipelines</h2>
            <p>Your suggestion to use separate threads for 10ms and 100ms signals is an excellent insight into prioritizing data. While that specific approach has limitations in Python, it leads to a more advanced and robust solution.</p>
            
            <h3>Analysis of the Two-Thread Proposal & The GIL Problem</h3>
            <p>The idea of having one thread for high-priority signals and another for low-priority seems logical. However, this runs into a core limitation of Python called the <strong>Global Interpreter Lock (GIL)</strong>.</p>
            <ul>
                <li><strong>What is the GIL?</strong> The GIL is a mutex (a type of lock) that protects access to Python objects, preventing multiple threads from executing Python bytecode at the same time within a single process.</li>
                <li><strong>The Impact:</strong> Even on a multi-core processor, only one thread can be executing Python code at any given moment. For CPU-heavy tasks like decoding CAN signals, threads do not provide true parallelism. They are taking turns on a single CPU core's worth of execution time.</li>
                <li><strong>Conclusion:</strong> Switching from the current multi-process pool to two threads would likely result in a performance *downgrade*, as the two threads would compete for resources instead of running in parallel.</li>
            </ul>
            <div class="diagram-container">
                 <h3>Threads vs. Processes: The GIL Explained</h3>
                 <svg viewBox="0 0 500 250" xmlns="http://www.w3.org/2000/svg">
                    <text x="125" y="20" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">Threading (Single Process)</text>
                    <rect x="25" y="30" width="200" height="100" fill="#2a2a2a" stroke="#aaa" rx="5"/>
                    <text x="125" y="50" font-family="sans-serif" font-size="12" fill="#ccc" text-anchor="middle">Process 1</text>
                    <rect x="60" y="70" width="50" height="20" fill="#81d4fa"/><text x="85" y="84" font-size="10" fill="#111" text-anchor="middle">Thread A</text>
                    <rect x="140" y="70" width="50" height="20" fill="#81d4fa"/><text x="165" y="84" font-size="10" fill="#111" text-anchor="middle">Thread B</text>

                    <rect x="115" y="130" width="20" height="30" fill="#f44336" rx="2"/>
                    <text x="125" y="150" font-family="sans-serif" font-size="12" fill="#fff" text-anchor="middle">GIL</text>
                    <line x1="85" y1="90" x2="125" y2="130" stroke="#ccc" stroke-width="1"/>
                    <line x1="165" y1="90" x2="125" y2="130" stroke="#ccc" stroke-width="1"/>

                    <line x1="125" y1="160" x2="75" y2="200" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>
                    <line x1="125" y1="160" x2="175" y2="200" stroke="#f44336" stroke-width="2" stroke-dasharray="4"/>
                    
                    <rect x="50" y="200" width="50" height="20" fill="#333"/><text x="75" y="214" font-size="10" fill="#ccc" text-anchor="middle">CPU 1</text>
                    <rect x="150" y="200" width="50" height="20" fill="#333"/><text x="175" y="214" font-size="10" fill="#ccc" text-anchor="middle">CPU 2</text>
                    <text x="125" y="240" font-size="12" fill="#aaa" text-anchor="middle">Only one thread runs at a time.</text>

                    <text x="375" y="20" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">Multiprocessing</text>
                    <rect x="275" y="30" width="90" height="100" fill="#2a2a2a" stroke="#aaa" rx="5"/>
                    <text x="320" y="50" font-size="12" fill="#ccc" text-anchor="middle">Process A</text>
                    <rect x="310" y="130" width="20" height="30" fill="#4caf50" rx="2"/><text x="320" y="150" font-size="12" fill="#fff" text-anchor="middle">GIL</text>
                    <line x1="320" y1="160" x2="320" y2="200" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>

                    <rect x="385" y="30" width="90" height="100" fill="#2a2a2a" stroke="#aaa" rx="5"/>
                    <text x="430" y="50" font-size="12" fill="#ccc" text-anchor="middle">Process B</text>
                    <rect x="420" y="130" width="20" height="30" fill="#4caf50" rx="2"/><text x="430" y="150" font-size="12" fill="#fff" text-anchor="middle">GIL</text>
                    <line x1="430" y1="160" x2="430" y2="200" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow)"/>

                    <rect x="295" y="200" width="50" height="20" fill="#333"/><text x="320" y="214" font-size="10" fill="#ccc" text-anchor="middle">CPU 1</text>
                    <rect x="405" y="200" width="50" height="20" fill="#333"/><text x="430" y="214" font-size="10" fill="#ccc" text-anchor="middle">CPU 2</text>
                    <text x="375" y="240" font-size="12" fill="#aaa" text-anchor="middle">True parallel execution.</text>
                </svg>
            </div>

            <h3>Recommended Solution: The "Dual Pipeline" Architecture</h3>
            <p>We can achieve your goal of prioritization *and* maintain performance by creating two parallel **processing pipelines** instead of just two threads. This is a hybrid approach that builds on the strengths of the current system.</p>
            <div class="diagram-container">
                <h3>Dual Pipeline Architecture Diagram</h3>
                <svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
                    <defs><marker id="arrow2" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#4fc3f7" /></marker></defs>
                    <rect x="10" y="10" width="780" height="480" fill="none" stroke="#555" stroke-width="2" rx="10"/>
                    <text x="400" y="35" font-family="sans-serif" font-size="16" fill="#ccc" text-anchor="middle">can_logger_app (Multiprocessing.Process)</text>

                    <rect x="30" y="215" width="120" height="50" fill="#333" rx="5"/><text x="90" y="245" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">CAN Hardware</text>
                    <rect x="210" y="215" width="120" height="50" fill="#3c3c3c" rx="5"/><text x="270" y="237" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">CANReader</text><text x="270" y="255" font-family="sans-serif" font-size="10" fill="#aaa" text-anchor="middle">(Single Thread)</text>
                    <line x1="150" y1="240" x2="210" y2="240" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow2)"/>

                    <!-- High Freq Pipeline -->
                    <text x="550" y="70" font-family="sans-serif" font-size="16" fill="#ff8a65" text-anchor="middle">High-Priority Pipeline (10ms)</text>
                    <ellipse cx="390" cy="120" rx="70" ry="18" fill="#ffccbc"/><text x="390" y="125" font-family="sans-serif" font-size="12" fill="#111" text-anchor="middle">high_freq_queue</text>
                    <path d="M 270 215 Q 270 130 320 125" stroke="#ff8a65" stroke-width="2" fill="none" marker-end="url(#arrow2)"/>
                    <rect x="500" y="100" width="150" height="50" fill="#3c3c3c" rx="5"/><text x="575" y="122" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">Worker Pool A</text><text x="575" y="140" font-family="sans-serif" font-size="10" fill="#aaa" text-anchor="middle">(N Processes)</text>
                    <line x1="460" y1="120" x2="500" y2="120" stroke="#ff8a65" stroke-width="2" marker-end="url(#arrow2)"/>

                    <!-- Low Freq Pipeline -->
                    <text x="550" y="310" font-family="sans-serif" font-size="16" fill="#90caf9" text-anchor="middle">Low-Priority Pipeline (100ms)</text>
                    <ellipse cx="390" cy="360" rx="70" ry="18" fill="#e3f2fd"/><text x="390" y="365" font-family="sans-serif" font-size="12" fill="#111" text-anchor="middle">low_freq_queue</text>
                    <path d="M 270 265 Q 270 350 320 355" stroke="#90caf9" stroke-width="2" fill="none" marker-end="url(#arrow2)"/>
                    <rect x="500" y="340" width="150" height="50" fill="#3c3c3c" rx="5"/><text x="575" y="362" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">Worker Pool B</text><text x="575" y="380" font-family="sans-serif" font-size="10" fill="#aaa" text-anchor="middle">(M Processes)</text>
                    <line x1="460" y1="360" x2="500" y2="360" stroke="#90caf9" stroke-width="2" marker-end="url(#arrow2)"/>

                    <!-- Final Output -->
                    <ellipse cx="700" cy="240" rx="50" ry="15" fill="#81d4fa"/><text x="700" y="245" font-family="sans-serif" font-size="12" fill="#111" text-anchor="middle">log_queue</text>
                    <path d="M 650 120 Q 680 180 680 225" stroke="#ff8a65" stroke-width="2" fill="none" marker-end="url(#arrow2)"/>
                    <path d="M 650 360 Q 680 300 680 255" stroke="#90caf9" stroke-width="2" fill="none" marker-end="url(#arrow2)"/>
                    <text x="700" y="450" font-family="sans-serif" font-size="14" fill="#ccc" text-anchor="middle">LogWriter -> can_log.json</text>
                    <line x1="700" y1="255" x2="700" y2="420" stroke="#4fc3f7" stroke-width="2" marker-end="url(#arrow2)"/>
                </svg>
            </div>
            <h4>Advantages of the Dual Pipeline Approach:</h4>
            <ul>
                <li><strong>Achieves Your Goal:</strong> It perfectly isolates the processing of 10ms signals from the 100ms signals. A burst of low-priority messages cannot delay the high-priority ones.</li>
                <li><strong>Maintains Performance:</strong> It continues to use multiple processes, bypassing the GIL to get true parallel decoding on multi-core systems.</li>
                <li><strong>No Reader Bottleneck:</strong> The main <code>CANReader</code> thread remains simple and fast. It just does a quick check to decide which of the two queues to put the raw message into.</li>
            </ul>
        </div>

    </div>
</body>
</html>
